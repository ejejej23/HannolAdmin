<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ridemain">
	<select id="getYears" parameterType="Integer" resultType="com.sp.rides.main.RidesMain">
		SELECT TO_CHAR(mpDate, 'YYYY') AS year
		FROM magicpass m
		JOIN facility f ON f.facilityCode = m.facilityCode
		JOIN theme t ON t.themeCode = f.themeCode
		<where>
			<if test="themaCode != '4'">
				t.themeCode = #{themaCode}
			</if>
		</where>
		GROUP BY TO_CHAR(mpDate, 'YYYY')
		ORDER BY years
	</select>
	
	<select id="themaList" resultType="com.sp.rides.main.RidesMain">
		SELECT themeCode AS themaCode, themeName AS themaName FROM theme
	    WHERE themeCode != 4
	    ORDER BY themeCode
	</select>
</mapper>